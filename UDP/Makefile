# Configuration du compilateur et des options
COMPILATEUR = gcc
OPTIONS = -I.

# D√©finition des programmes
PROGRAMMES = client serveur

# Fichiers source
SOURCES_CLIENT = client.c
SOURCES_SERVEUR = serveur.c

# G√©n√©ration automatique des noms de fichiers objets
OBJETS_CLIENT = $(SOURCES_CLIENT:.c=.o)
OBJETS_SERVEUR = $(SOURCES_SERVEUR:.c=.o)

# Tous les fichiers objets combin√©s
TOUS_OBJETS = $(OBJETS_CLIENT) $(OBJETS_SERVEUR)

# R√®gle par d√©faut
.DEFAULT_GOAL := tout

# Compilation compl√®te
tout: message_debut $(PROGRAMMES) message_fin

# Message de d√©but de compilation
message_debut:
	@echo "üöÄ D√©marrage de la compilation du UDP..."

# Message de fin de compilation
message_fin:
	@echo "‚ú® Compilation termin√©e avec succ√®s!"

# R√®gle pour le client
client: $(OBJETS_CLIENT)
	@echo "üî® Assemblage du client..."
	@$(COMPILATEUR) $(OPTIONS) -o $@ $^
	@echo "‚úÖ Client pr√™t!"

# R√®gle pour le serveur
serveur: $(OBJETS_SERVEUR)
	@echo "üî® Assemblage du serveur..."
	@$(COMPILATEUR) $(OPTIONS) -o $@ $^
	@echo "‚úÖ Serveur pr√™t!"

# Compilation des fichiers source
%.o: %.c
	@echo "üìù Compilation de $<..."
	@$(COMPILATEUR) $(OPTIONS) -c $< -o $@

# Nettoyage simple
nettoyer:
	@echo "üßπ Nettoyage des fichiers temporaires..."
	@rm -f $(TOUS_OBJETS)
	@echo "‚ú® Nettoyage termin√©"

# Nettoyage complet
purger: nettoyer
	@echo "üóëÔ∏è  Suppression des ex√©cutables..."
	@rm -f $(PROGRAMMES)
	@echo "‚ú® Purge termin√©e"

# Recompilation compl√®te
redo: purger tout

# Affichage de l'help
help:
	@echo "üìö Guide d'utilisation du Makefile:"
	@echo "  make ou make tout    ‚Üí Compile tout le projet"
	@echo "  make client         ‚Üí Compile uniquement le client"
	@echo "  make serveur        ‚Üí Compile uniquement le serveur"
	@echo "  make nettoyer       ‚Üí Supprime les fichiers objets"
	@echo "  make purger         ‚Üí Supprime tout (objets et programmes)"
	@echo "  make redo    ‚Üí Recompile tout depuis z√©ro"
	@echo "  make help           ‚Üí Affiche ce message"

# D√©clarer les cibles qui ne sont pas des fichiers
.PHONY: tout message_debut message_fin nettoyer purger redo help